version: '2'

services:

  development:
    build:
      context: .
      dockerfile: docker/Dev.dockerfile
    image: dnsmq-messagebus-development
    stdin_open: true
    tty: true
    volumes:
      - "./.babelrc:/dnsmq-messagebus/.babelrc"
      - "./src:/dnsmq-messagebus/src"
      - "./lib:/dnsmq-messagebus/lib"
      - "./tests-src:/dnsmq-messagebus/tests-src"
      - "./tests:/dnsmq-messagebus/tests"
      - "./package.json:/dnsmq-messagebus/package.json"

  bus:
    build:
      context: .
      dockerfile: docker/Dev.dockerfile
    image: dnsmq-messagebus-development
    command: ["node", "tests/startDNSNode"]
    stdin_open: true
    tty: true
    volumes:
      - "./.babelrc:/dnsmq-messagebus/.babelrc"
      - "./src:/dnsmq-messagebus/src"
      - "./lib:/dnsmq-messagebus/lib"
      - "./tests-src:/dnsmq-messagebus/tests-src"
      - "./tests:/dnsmq-messagebus/tests"
      - "./package.json:/dnsmq-messagebus/package.json"
    environment:
      - CODE_PATH=lib
      - DEBUG=dnsmq-messagebus:*,-dnsmq-messagebus:SUB:heartbeats,-dnsmq-messagebus:masterbroker:heartbeats,-dnsmq-messagebus:PUB
